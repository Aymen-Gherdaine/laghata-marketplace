"use strict";(self.webpackChunklaghata_frontend=self.webpackChunklaghata_frontend||[]).push([[880],{5920:(n,e,t)=>{t.d(e,{Z:()=>J});var i,r,s,a,o,d,c,l,p,x,h,u,f,g,m,b=t(168),v=t(2791),Z=t(8789),j=t(3584),w=t(7692),y=t(3198),P=t(184);const k=Z.ZP.div(i||(i=(0,b.Z)(["\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n"]))),C=Z.ZP.div(r||(r=(0,b.Z)(["\n  width: 290px;\n  height: 400px;\n  border: 1px solid #000;\n  background-color: #f5f5f3;\n  border-radius: 10px;\n  transition: all 0.5s ease;\n\n  border: 1px solid;\n  z-index: 99999;\n  position: relative;\n"]))),I=Z.ZP.div(s||(s=(0,b.Z)(["\n  height: 340px;\n  overflow-x: hidden;\n  overflow-y: auto;\n\n  ::-webkit-scrollbar {\n    width: 8px;\n    height: 8px;\n  }\n\n  ::-webkit-scrollbar-thumb {\n    background: white;\n    border-radius: 50px;\n  }\n\n  ::-webkit-scrollbar-track {\n    background: #f5f0ed;\n    border-radius: 50px;\n    border-top-right-radius: 25px;\n    border-top-left-radius: 25px;\n  }\n"]))),U=Z.ZP.div(a||(a=(0,b.Z)(["\n  display: flex;\n  flex-direction: column;\n  padding: 9px 10px;\n"]))),E=Z.ZP.div(o||(o=(0,b.Z)(["\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  gap: 7px;\n  padding-top: 13px;\n"]))),S=Z.ZP.div(d||(d=(0,b.Z)(["\n  display: flex;\n  align-items: center;\n  gap: 5px;\n"]))),_=Z.ZP.div(c||(c=(0,b.Z)(["\n  /* max-height: 345px; */\n"]))),z=Z.ZP.div(l||(l=(0,b.Z)(["\n  background-color: #fff;\n  width: fit-content;\n  border-radius: 25px;\n  padding: 10px 12px;\n  font-size: 15px;\n  font-weight: 400;\n"]))),N=Z.ZP.div(p||(p=(0,b.Z)(["\n  display: flex;\n  align-items: flex-start;\n  justify-content: center;\n  gap: 6px;\n  padding-top: 13px;\n"]))),O=Z.ZP.div(x||(x=(0,b.Z)(["\n  background-color: #fff;\n  width: 80%;\n  border-radius: 25px;\n  padding: 10px 12px;\n  font-size: 15px;\n  font-weight: 400;\n"]))),M=Z.ZP.img(h||(h=(0,b.Z)(["\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n"]))),T=Z.ZP.textarea(u||(u=(0,b.Z)(["\n  position: absolute;\n  bottom: 7px;\n  left: 5px;\n  padding-left: 9px;\n  padding-top: 10px;\n  width: 85%;\n  height: 40px;\n  outline: none;\n  border-radius: 25px;\n  border: 1px solid #000;\n  background-color: transparent;\n"]))),D=Z.ZP.button(f||(f=(0,b.Z)(["\n  position: absolute;\n  bottom: 7px;\n  right: 5px;\n  height: 40px;\n  width: 10%;\n  border-radius: 50%;\n  border: none;\n  background-color: transparent;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.5s ease;\n  border: 1px solid;\n\n  :hover {\n    border: none;\n    transform: scale(0.9);\n  }\n\n  .sendIcon {\n    font-size: 22px;\n    color: #242526;\n  }\n"]))),R=Z.ZP.div(g||(g=(0,b.Z)(["\n  background: #000;\n  color: #f5f0ed;\n  padding: 7px 10px;\n  border-radius: 25px;\n  opacity: 0;\n  cursor: pointer;\n  transition: all 0.4s ease;\n  font-size: 15px;\n\n  :hover {\n    opacity: 1;\n  }\n"]))),A=Z.ZP.button(m||(m=(0,b.Z)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 9px;\n  background-color: transparent;\n  border: none;\n  border-radius: 50%;\n  height: 80px;\n  cursor: pointer;\n  transition: all 0.33s ease;\n\n  :hover {\n    .msg-display {\n      opacity: 1;\n    }\n  }\n\n  img {\n    width: 60px;\n    height: 60px;\n    border-radius: 50%;\n  }\n"]))),J=n=>{let{picture:e,renterUsername:t,openChat:i,setOpenChat:r,currentUserName:s,currentUserPicture:a,currentUserId:o,renterId:d}=n;const[c,l]=(0,v.useState)(""),{currentChatMembers:p,setCurrentChatMembers:x,message:h,setMessage:u,chatConversation:f,setChatConversation:g,notification:m,setNotification:b,socket:Z}=(0,v.useContext)(y.p),J=(0,v.useRef)(),F=(0,v.useRef)(!1);(0,v.useEffect)((()=>{if(!1===F.current){return(async()=>{const n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({senderId:o,receiverId:d,createAt:Date.now()})};try{const e=await fetch("".concat("http://15.222.85.66","/api/conversation"),n),t=await e.json();201===t.status&&x(t.data)}catch(e){console.log(e.stack)}})(),()=>{F.current=!0}}}),[o,d]),(0,v.useEffect)((()=>{try{(async()=>{const n=await fetch("".concat("http://15.222.85.66","/api/conversation/").concat(o)),e=await n.json();if(e.data.length>0){const n=e.data.find((n=>n.members[0]===o&&n.members[1]===d||n.members[1]===o&&n.members[0]===d));x(n)}})()}catch(n){console.log(n.stack)}}),[]),(0,v.useEffect)((()=>{Z&&(Z.emit("welcome-message",{currentUserName:s,renterUsername:t}),Z.emit("initialisation-add-user",o),Z.on("welcome-response",(n=>{l(n)})))}),[Z,s,o]),(0,v.useEffect)((()=>{(async()=>{try{const n=await fetch("".concat("http://15.222.85.66","/api/messages/").concat(null===p||void 0===p?void 0:p._id)),e=await n.json();e.data.length>0&&g(e.data)}catch(n){console.log(n.stack)}})()}),[p]),(0,v.useEffect)((()=>{Z&&Z.on("getMessage",(n=>{var e,t;!0===(null===p||void 0===p||null===(e=p.members)||void 0===e?void 0:e.includes(n.senderId))&&!0===(null===p||void 0===p||null===(t=p.members)||void 0===t?void 0:t.includes(n.sendToId))?g([...f,n]):i||m.includes(n)||b([...m,n])}))}),[Z,f,m,i]);const H=async n=>{n.preventDefault();const e={senderId:o,conversationId:null===p||void 0===p?void 0:p._id,receiverId:d,text:h,createAt:Date.now()};Z.emit("sendMessage",e),u("");try{const n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};(await fetch("".concat("http://15.222.85.66","/api/message"),n)).ok&&g([...f,e])}catch(t){console.log(t.stack)}};let K=(0,j.Z)((()=>{r(!1)}));return(0,v.useEffect)((()=>{var n;null===(n=J.current)||void 0===n||n.scrollIntoView({behavior:"smooth"})}),[f]),(0,P.jsxs)(k,{ref:K,children:[i&&(0,P.jsxs)(C,{children:[(0,P.jsxs)(I,{children:[0===f.length&&(0,P.jsxs)(N,{children:[(0,P.jsx)(M,{src:e,alt:"userProfile"}),(0,P.jsx)(O,{children:c.text})]}),(0,P.jsx)(_,{children:f.map(((n,t)=>(0,P.jsx)(U,{ref:J,children:n.senderId!==o&&n.senderId===d?(0,P.jsxs)(E,{children:[(0,P.jsx)(z,{children:n.text},t),(0,P.jsx)(M,{src:e,alt:"RenterProfile"})]}):n.senderId===o&&n.receiverId===d&&(0,P.jsxs)(S,{children:[(0,P.jsx)(M,{src:a,alt:"userProfile"}),(0,P.jsx)(z,{children:n.text})]})},t)))})]}),(0,P.jsxs)("form",{onSubmit:H,children:[(0,P.jsx)(T,{value:h,placeholder:"Message",onChange:n=>u(n.target.value),onKeyDown:n=>"Enter"===n.key?H(n):null}),(0,P.jsx)(D,{type:"submit",children:(0,P.jsx)(w.PRb,{className:"sendIcon"})})]})]}),(0,P.jsxs)(A,{onClick:()=>{r(!i)},children:[(0,P.jsxs)(R,{className:"msg-display",children:["Hey i'm ",t,"!"]}),(0,P.jsx)("img",{src:e,alt:"renter picture"})]})]})}},6131:(n,e,t)=>{t.r(e),t.d(e,{default:()=>R});var i=t(168),r=t(2791),s=t(7689),a=t(8789);const o=t.p+"static/media/profilepage.9accf1ad4c78c954c56b.jpg";var d,c,l,p,x,h,u,f,g,m,b,v,Z=t(5671),j=t(5920),w=t(4448),y=t(3198),P=t(8179),k=t(184);const C=a.ZP.div(d||(d=(0,i.Z)(["\n  min-height: 100vh;\n  display: flex;\n  flex-direction: column;\n  padding-bottom: 220px;\n\n  .spinner {\n    height: 80vh;\n    width: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n"]))),I=a.ZP.div(c||(c=(0,i.Z)([""]))),U=a.ZP.div(l||(l=(0,i.Z)(["\n  height: 160px;\n  position: relative;\n\n  h2 {\n    position: absolute;\n    top: 50px;\n    left: 20px;\n    font-size: 35px;\n    font-weight: 900;\n    text-transform: capitalize;\n    color: #242526;\n  }\n"]))),E=a.ZP.img(p||(p=(0,i.Z)(["\n  height: 160px;\n  width: 100%;\n  object-fit: cover;\n  opacity: 0.3;\n"]))),S=a.ZP.div(x||(x=(0,i.Z)(["\n  display: flex;\n  max-width: 1300px;\n  margin: 0 auto;\n  align-items: flex-start;\n\n  @media screen and (max-width: 700px) {\n    flex-direction: column-reverse;\n  }\n\n  @media screen and (max-width: 1300px) {\n    gap: 100px;\n  }\n"]))),_=a.ZP.div(h||(h=(0,i.Z)(["\n  position: fixed;\n  bottom: 24px;\n  right: 24px;\n"]))),z=a.ZP.div(u||(u=(0,i.Z)(["\n  flex: 0.3;\n  margin: 50px auto;\n  width: 80%;\n\n  @media screen and (max-width: 700px) {\n    width: 70%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n  }\n\n  @media screen and (min-width: 1300px) {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n  }\n"]))),N=a.ZP.div(f||(f=(0,i.Z)(["\n  flex: 0.7;\n"]))),O=a.ZP.div(g||(g=(0,i.Z)(["\n  display: flex;\n  justify-content: center;\n  flex-wrap: wrap;\n  gap: 15px;\n"]))),M=a.ZP.h2(m||(m=(0,i.Z)(["\n  padding: 19px 41px;\n\n  @media screen and (max-width: 700px) {\n    margin-bottom: 15px;\n  }\n"]))),T=a.ZP.img(b||(b=(0,i.Z)(["\n  width: 70%;\n  height: 240px;\n  border-radius: 10px;\n  margin-bottom: 10px;\n"]))),D=a.ZP.button(v||(v=(0,i.Z)(["\n  padding: 10px 25px;\n  width: 70%;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 500;\n  background: transparent;\n  border-radius: 5px;\n  border: 1px solid;\n  transition: background 0.5s ease-in-out;\n\n  :hover {\n    background-color: #dadce1;\n  }\n"]))),R=()=>{const{openChat:n,setOpenChat:e}=(0,r.useContext)(y.p),{user:t}=(0,r.useContext)(P.E),[i,a]=(0,r.useState)(!1),[d,c]=(0,r.useState)(),[l,p]=(0,r.useState)([]),{id:x}=(0,s.UO)();return(0,r.useEffect)((()=>{try{a(!0);(async()=>{const n=await fetch("".concat("http://15.222.85.66","/api/renter-listing/").concat(x)),e=await n.json(),t=await fetch("".concat("http://15.222.85.66","/api/user/").concat(x)),i=await t.json();if(e.data&&i.data){c(e.data);const n=[i.data];p(n),a(!1)}else a(!1)})()}catch(n){console.log(n.stack),a(!1)}}),[x]),(0,k.jsx)(C,{children:i?(0,k.jsx)(w.Z,{}):(0,k.jsx)(k.Fragment,{children:d&&l&&!i&&(0,k.jsxs)(I,{children:[(0,k.jsxs)(U,{children:[(0,k.jsx)(E,{src:o,alt:"banner"}),(0,k.jsx)("h2",{children:l[0].username})]}),(0,k.jsxs)(S,{children:[(0,k.jsxs)(N,{children:[(0,k.jsxs)(M,{children:[d.length," open listing"]}),(0,k.jsx)(O,{children:d.map((n=>(0,k.jsx)(Z.Z,{listing:n,renters:l},n._id)))})]}),(0,k.jsxs)(z,{children:[(0,k.jsx)(T,{src:l[0].picture}),(0,k.jsxs)(D,{onClick:()=>{t?e(!0):navigate("/login")},children:["Contact ",l[0].username]})]})]}),t&&(null===t||void 0===t?void 0:t._id)!==l[0]._id&&(0,k.jsx)(_,{children:(0,k.jsx)(j.Z,{picture:l[0].picture,renterUsername:l[0].username,renterId:l[0]._id,openChat:n,setOpenChat:e,currentUserName:null===t||void 0===t?void 0:t.username,currentUserPicture:null===t||void 0===t?void 0:t.picture,currentUserId:null===t||void 0===t?void 0:t._id})})]})})})}}}]);
//# sourceMappingURL=880.1f95c738.chunk.js.map