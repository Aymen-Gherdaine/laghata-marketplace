"use strict";(self.webpackChunklaghata_frontend=self.webpackChunklaghata_frontend||[]).push([[110],{2211:(n,e,t)=>{t.r(e),t.d(e,{default:()=>B});var i,o,a,s,r=t(168),d=t(2791),c=t(8789),l=t(184);const p=c.ZP.div(i||(i=(0,r.Z)(["\n  margin: 0px 15px;\n  padding: 20px;\n  width: fit-content;\n  cursor: pointer;\n  transition: all 0.5s ease-in-out;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 13px;\n  position: relative;\n\n  :hover {\n    background-color: #f5f0ed;\n  }\n"]))),x=c.ZP.img(o||(o=(0,r.Z)(["\n  width: 50px;\n  height: 50px;\n  border-radius: 50%;\n"]))),h=c.ZP.p(a||(a=(0,r.Z)(["\n  font-weight: 700px;\n"]))),u=c.ZP.span(s||(s=(0,r.Z)(["\n  width: 19px;\n  height: 19px;\n  border-radius: 50%;\n  background: white;\n  color: black;\n  position: absolute;\n  top: 15px;\n\n  right: 13px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),f=n=>{let{conversation:e,currentUserId:t,setCurrentChatConversation:i,setClientPicture:o,setNotification:a,notification:s}=n;const[r,c]=(0,d.useState)(null);(0,d.useEffect)((()=>{const n=e.members.find((n=>n!==t));(async()=>{try{if(n){const e=await fetch("".concat("http://15.222.85.66","/api/user/").concat(n)),t=await e.json();t.data&&(c(t.data),o(t.data.picture))}}catch(e){console.log(e.stack)}})()}),[t,e]);let f=0;s&&r&&s.map((n=>(n.senderId===r._id&&(f+=1),f)));return(0,l.jsxs)(p,{onClick:()=>{i(e),a(s.filter((n=>n.senderId!==r._id)))},children:[(0,l.jsx)(x,{src:null===r||void 0===r?void 0:r.picture}),f>0&&(0,l.jsx)(u,{children:f}),(0,l.jsx)(h,{children:null===r||void 0===r?void 0:r.username})]},e._id)};var g,v,m,b,w,Z,j,y,k,P,_,C,I,S,E=t(3198),D=t(8179),N=t(7692),z=t(3101);const R=c.ZP.div(g||(g=(0,r.Z)(["\n  min-height: 100vh;\n  background-color: #f5f0ed;\n  position: relative;\n"]))),F=c.ZP.div(v||(v=(0,r.Z)(["\n  max-width: 950px;\n  width: 90%;\n  margin: 0 auto;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n\n  .spinner {\n    margin-top: 60px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n"]))),M=c.ZP.div(m||(m=(0,r.Z)(["\n  display: flex;\n  align-items: flex-start;\n  gap: 15px;\n"]))),A=c.ZP.span(b||(b=(0,r.Z)(["\n  font-size: 50px;\n  width: 100%;\n  text-align: center;\n  color: #f5f5f3;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n\n  @media screen and (max-width: 700px) {\n    font-size: 35px;\n  }\n"]))),K=c.ZP.div(w||(w=(0,r.Z)(['\n  margin: 20px 0;\n  padding: 10px;\n  height: 70vh;\n  background-image: url("https://cdn.wallpapersafari.com/19/15/HlpKYq.png");\n  background-size: contain;\n  position: relative;\n  border-radius: 25px;\n\n  @media screen and (max-width: 700px) {\n    height: 60vh;\n  }\n']))),O=c.ZP.div(Z||(Z=(0,r.Z)([""]))),T=c.ZP.div(j||(j=(0,r.Z)(["\n  display: flex;\n  flex-direction: column;\n  padding: 9px 10px;\n"]))),U=c.ZP.div(y||(y=(0,r.Z)(["\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  gap: 7px;\n  padding-top: 13px;\n"]))),q=c.ZP.div(k||(k=(0,r.Z)(["\n  display: flex;\n  align-items: center;\n  gap: 5px;\n"]))),H=c.ZP.img(P||(P=(0,r.Z)(["\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n"]))),J=c.ZP.div(_||(_=(0,r.Z)(["\n  overflow-x: hidden;\n  overflow-y: scroll;\n  height: 90%;\n\n  ::-webkit-scrollbar {\n    width: 8px;\n    height: 8px;\n  }\n\n  ::-webkit-scrollbar-thumb {\n    background: #f5f0ed;\n    border-radius: 50px;\n  }\n\n  ::-webkit-scrollbar-track {\n    background: #f5f0ed;\n    border-radius: 50px;\n  }\n\n  @media screen and (max-width: 700px) {\n    height: 85%;\n  }\n"]))),L=c.ZP.div(C||(C=(0,r.Z)(["\n  background-color: #fff;\n  width: fit-content;\n  border-radius: 25px;\n  padding: 10px 12px;\n  font-size: 15px;\n  font-weight: 400;\n"]))),V=c.ZP.input(I||(I=(0,r.Z)(["\n  position: absolute;\n  bottom: 7px;\n  left: 10px;\n  padding-left: 9px;\n  width: 90%;\n  height: 40px;\n  outline: none;\n  border-radius: 25px;\n  border: 1px solid white;\n  color: white;\n  background-color: transparent;\n\n  @media screen and (max-width: 700px) {\n    width: 80%;\n  }\n"]))),Y=c.ZP.button(S||(S=(0,r.Z)(["\n  border: 1px solid white;\n  .sendIcon {\n    font-size: 40px;\n    color: #f5f0ed;\n    position: absolute;\n    bottom: 10px;\n    right: 20px;\n    border-radius: 50%;\n    border: none;\n    background-color: transparent;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n"]))),B=()=>{const{socket:n,setNotification:e,notification:t}=(0,d.useContext)(E.p),{user:i}=(0,d.useContext)(D.E),[o,a]=(0,d.useState)(!1),[s,r]=(0,d.useState)([]),[c,p]=(0,d.useState)(null),[x,h]=(0,d.useState)([]),[u,g]=(0,d.useState)(""),[v,m]=(0,d.useState)(""),[b,w]=(0,d.useState)(),Z=(0,d.useRef)();(0,d.useEffect)((()=>{n&&(null===n||void 0===n||n.on("getMessage",(n=>{m({senderId:n.senderId,text:n.text,createdAt:new Date(Date.now())})})))}),[n]),(0,d.useEffect)((()=>{v&&(null===c||void 0===c?void 0:c.members.includes(v.senderId))&&h((n=>[...n,v]))}),[v,c]),(0,d.useEffect)((()=>{try{(async()=>{const n=await fetch("".concat("http://15.222.85.66","/api/conversation/").concat(null===i||void 0===i?void 0:i._id)),e=await n.json();e.data.length>0&&r(e.data)})()}catch(n){console.log(n.stack)}}),[null===i||void 0===i?void 0:i._id]),(0,d.useEffect)((()=>{a(!0);(async()=>{try{const n=await fetch("".concat("http://15.222.85.66","/api/messages/").concat(null===c||void 0===c?void 0:c._id)),e=await n.json();e.data.length>0&&(h(e.data),a(!1))}catch(n){console.log(n.stack),a(!1)}a(!1)})()}),[c]);const j=async e=>{e.preventDefault();const t=c.members.find((n=>n!==(null===i||void 0===i?void 0:i._id))),o={senderId:null===i||void 0===i?void 0:i._id,text:u,receiverId:t,conversationId:c._id,createAt:new Date(Date.now())};n.emit("sendMessage",{senderId:null===i||void 0===i?void 0:i._id,receiverId:t,text:u}),g("");try{const n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)};(await fetch("".concat("http://15.222.85.66","/api/message"),n)).ok&&h([...x,o])}catch(a){console.log(a.stack)}};return(0,d.useEffect)((()=>{var n;null===(n=Z.current)||void 0===n||n.scrollIntoView({behavior:"smooth"})}),[x]),(0,l.jsx)(R,{children:(0,l.jsx)(F,{children:s&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(M,{children:s.map((n=>(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(f,{conversation:n,currentUserId:null===i||void 0===i?void 0:i._id,setCurrentChatConversation:p,setClientPicture:w,setNotification:e,notification:t},n._id)})))}),o?(0,l.jsx)(z.p2,{height:"30",width:"30",color:"#242526",ariaLabel:"circles-loading",wrapperClass:"spinner",visible:!0}):(0,l.jsx)(K,{children:c?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(J,{children:x.map((n=>(0,l.jsx)(T,{children:n.senderId!==(null===i||void 0===i?void 0:i._id)?(0,l.jsxs)(U,{children:[(0,l.jsx)(L,{children:n.text}),(0,l.jsx)(H,{src:b,alt:"RenterProfile"})]},n._id):(0,l.jsxs)(q,{children:[(0,l.jsx)(H,{src:null===i||void 0===i?void 0:i.picture,alt:"RenterProfile"}),(0,l.jsx)(L,{children:n.text})]},n._id)},n._id)))}),(0,l.jsxs)(O,{onSubmit:j,children:[(0,l.jsx)(V,{value:u,placeholder:"Message",onChange:n=>g(n.target.value),onKeyDown:n=>"Enter"===n.key?j(n):null}),(0,l.jsx)(Y,{type:"submit",children:(0,l.jsx)(N.PRb,{className:"sendIcon"})})]})]}):(0,l.jsx)(A,{children:"No chat selected"})})]})})})}}}]);
//# sourceMappingURL=110.f5001800.chunk.js.map